
Starting OCS Inventory NG Management server setup on 2023-01-27-09-27-06
from folder /home/admin/OCSNG_UNIX_SERVER-2.11.1
Storing log in file /home/admin/OCSNG_UNIX_SERVER-2.11.1/ocs_server_setup.log

============================================================
Checking OCS Inventory NG Management Server requirements...
============================================================
Checking for database server properties
MySQL client distribution version 10.5.
Computer seems to be running MySQL 4.1 or higher
Database server is running on host localhost
Database server is running on port 3306
Checking for Apache web server daemon
Found Apache daemon /usr/sbin/apache2ctl
Using Apache daemon /usr/sbin/apache2ctl
Checking for Apache main configuration file
Found Apache HTTPD_ROOT /etc/apache2
Found Apache SERVER_CONFIG_FILE apache2.conf
Found Apache main configuration file /etc/apache2/apache2.conf
Using Apache main configuration file /etc/apache2/apache2.conf
Checking for Apache user account
Found Apache user account www-data
Using Apache user account www-data
Checking for Apache group
Found Apache user group www-data
Using Apache user group www-data
Checking for Apache Include configuration directory
Found Apache Include configuration directory /etc/apache2/conf-available
Using Apache Include configuration directory /etc/apache2/conf-available
Checking for PERL Interpreter
Found PERL interpreter at </usr/bin/perl>
Using PERL interpreter /usr/bin/perl

============================================================
Installing Communication server
============================================================
Checking for Make utility
Make utility found at </usr/bin/make>
Checking for Apache mod_perl version 1.99_22 or higher
mod_perl 1.99_22 or higher is available
Using mod_perl version 1.99_22 or higher
Checking for Communication server log directory
Using /var/log/ocsinventory-server as Communication server log directory
Checking for Communication server plugins configuration directory
Using /etc/ocsinventory-server/plugins as Communication server plugins configuration directory
Checking for Communication server perl directory
Using /etc/ocsinventory-server/perl as Communication server plugins perl directory
Entering Apache sub directory
Checking for DBI PERL module
PERL module DBI is available
Checking for Apache::DBI PERL module
PERL module Apache::DBI is available
Checking for DBD::mysql PERL module
PERL module DBD::mysql is available
Checking for Compress::Zlib PERL module
PERL module Compress::Zlib is available
Checking for XML::Simple PERL module
PERL module XML::Simple is available
Checking for Net::IP PERL module
PERL module Net::IP is available
Checking for Archive::Zip Perl module
PERL module Archive::Zip is available
PERL module Mojolicious::Lite is available
PERL module Switch is available
PERL module Plack::Handler is available
Copying files to /usr/local/share/perl/5.32.1
Configuring Rest API server (file ocsinventory-restapi.conf)
Writing Rest API configuration to file /etc/apache2/conf-available/ocsinventory-restapi.conf
Configuring Communication server (perl Makefile.PL)
Preparing Communication server Perl modules (make)
Skip blib/lib/Apache/Ocsinventory/Interface/History.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Notify.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Updates.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Saas.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/SoftwareCategory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Map.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Datafilter.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Snmp.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Filter.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Config.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Download.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Registry.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Database.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Internals.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Plugins.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/SOAP.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Example.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Inventory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Plugins/Modules.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/AssetCategory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Ipdiscover.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Ipdiscover.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Download/Inventory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Snmp.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Interface/Extensions.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Update/AccountInfos.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Update/Hardware.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Duplicate.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Export.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Snmp/Data.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Update.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/System/Config.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Communication.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/System.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Software.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Modperl2.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Communication/Session.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Update.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Modperl1.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Groups.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Capacities/Snmp/Inventory.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Filter.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Capacities.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Data.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Constants.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Useragent.pm (unchanged)
Skip blib/lib/Apache/Ocsinventory/Server/Inventory/Cache.pm (unchanged)
Installing Communication server Perl modules (make install)
Appending installation info to /usr/local/lib/aarch64-linux-gnu/perl/5.32.1/perllocal.pod
Creating Communication server log directory /var/log/ocsinventory-server
Fixing Communication server log directory permissions
Configuring logrotate (ed logrotate.ocsinventory-NG)
******** Begin updated logrotate.ocsinventory-server.local ***********
# Rotate OCS Inventory NG Communication server logs daily
# Save 7 days old logs in compressed mode
/var/log/ocsinventory-server/*.log {
	daily
	rotate 7
	compress
	delaycompress
	missingok
}
******** End updated logrotate.COM_SERVER_LOGROTATE_CONF_FILE.local ***********
Removing old communication server logrotate file /etc/logrotate.d/ocsinventory-NG
Writing communication server logrotate to file /etc/logrotate.d/ocsinventory-server
Creating Communication server plugins configuration directory /etc/ocsinventory-server/plugins
Creating Communication server plugins Perl directory /etc/ocsinventory-server/perl
OK, using 'z-ocsinventory-server.conf' as Communication Server Apache configuration file
Configuring Apache web server (file ocsinventory-server.conf)
******** Begin updated ocsinventory-server.conf.local ***********
################################################################################
#
# OCS Inventory NG Communication Server Perl Module Setup
#
# Copyleft 2006 Pascal DANEK
# Web: http://www.ocsinventory-ng.org
#
# This code is open source and may be copied and modified as long as the source
# code is always made freely available.
# Please refer to the General Public Licence http://www.gnu.org/ or Licence.txt
################################################################################

<IfModule mod_perl.c>
 
  # Which version of mod_perl we are using
  # For mod_perl <= 1.999_21, replace 2 by 1
  # For mod_perl > 1.999_21, replace 2 by 2
  PerlSetEnv OCS_MODPERL_VERSION 2

  # Master Database settings
  # Replace localhost by hostname or ip of MySQL server for WRITE
  PerlSetEnv OCS_DB_HOST localhost
  # Replace 3306 by port where running MySQL server, generally 3306
  PerlSetEnv OCS_DB_PORT 3306
  # Name of database
  PerlSetEnv OCS_DB_NAME ocsweb
  PerlSetEnv OCS_DB_LOCAL ocsweb
  # User allowed to connect to database
  PerlSetEnv OCS_DB_USER ocs
  # Password for user
  PerlSetVar OCS_DB_PWD ocs
  # SSL Configuration
  # 0 to disable the SSL support for MySQL/MariaDB
  # 1 to enable the SSL support for MySQL/MariaDB
  PerlSetEnv OCS_DB_SSL_ENABLED 0
  # PerlSetEnv OCS_DB_SSL_CLIENT_KEY /etc/ssl/private/client.key
  # PerlSetEnv OCS_DB_SSL_CLIENT_CERT /etc/ssl/certs/client.crt
  # PerlSetEnv OCS_DB_SSL_CA_CERT /etc/ssl/certs/ca.crt
  # SSL Mode 
  # - SSL_MODE_PREFERRED (SSL enabled but optional)
  # - SSL_MODE_REQUIRED (SSL enabled, mandatory but don't verify server certificate. Ex self signed cert)
  # - SSL_MODE_STRICT (SSL enabled, mandatory and server cert must be trusted)
  PerlSetEnv OCS_DB_SSL_MODE SSL_MODE_PREFERRED
  

  #Â Slave Database settings
  # Replace localhost by hostname or ip of MySQL server for READ
  # Useful if you handle mysql slave databases
  # PerlSetEnv OCS_DB_SL_HOST localhost
  # Replace 3306 by port where running MySQL server, generally 3306
  # PerlSetEnv OCS_DB_SL_PORT_SLAVE 3306
  # User allowed to connect to database
  # PerlSetEnv OCS_DB_SL_USER ocs
  # Name of the database
  # PerlSetEnv OCS_DB_SL_NAME ocsweb
  # Password for user
  # PerlSetVar OCS_DB_SL_PWD ocs
  # SSL Configuration for Slave database
  # 0 to disable the SSL support for MySQL/MariaDB
  # 1 to enable the SSL support for MySQL/MariaDB
  # PerlSetEnv OCS_DB_SL_SSL_ENABLED 0
  # PerlSetEnv OCS_DB_SL_SSL_CLIENT_KEY /etc/ssl/private/client.key
  # PerlSetEnv OCS_DB_SL_SSL_CLIENT_CERT /etc/ssl/certs/client.crt
  # PerlSetEnv OCS_DB_SL_SSL_CA_CERT /etc/ssl/certs/ca.crt
  # SSL Mode 
  # - SSL_MODE_PREFERRED (SSL enabled but optional)
  # - SSL_MODE_REQUIRED (SSL enabled, mandatory but don't verify server certificate. Ex self signed cert)
  # - SSL_MODE_STRICT (SSL enabled, mandatory and server cert must be trusted)
  # PerlSetEnv OCS_DB_SL_SSL_MODE SSL_MODE_PREFERRED
  
  # Path to log directory (must be writeable)
  PerlSetEnv OCS_OPT_LOGPATH "/var/log/ocsinventory-server"
  
  # If you need to specify a mysql socket that the client's built-in
  #PerlSetEnv OCS_OPT_DBI_MYSQL_SOCKET "path/to/mysql/unix/socket"
  # DBI verbosity
  PerlSetEnv OCS_OPT_DBI_PRINT_ERROR 0
  
  # Unicode support
  PerlSetEnv OCS_OPT_UNICODE_SUPPORT 1

  # If you are using a multi server architecture, 
  # Put the ip addresses of the slaves on the master
  # (This is read as perl regular expressions)
  PerlAddVar OCS_OPT_TRUSTED_IP 127.0.0.1
  #PerlAddVar OCS_OPT_TRUSTED_IP XXX.XXX.XXX.XXX

# Be careful: you must restart apache to make settings taking effects

  # Configure engine to use the settings from this file  
  PerlSetEnv OCS_OPT_OPTIONS_NOT_OVERLOADED 0

  # Try to use other compress algorithm than raw zlib
  # GUNZIP and clear XML are supported
  PerlSetEnv OCS_OPT_COMPRESS_TRY_OTHERS 1
  
##############################################################
# ===== OPTIONS BELOW ARE OVERLOADED IF YOU USE OCS GUI =====#
##############################################################

# NOTE: IF YOU WANT TO USE THIS CONFIG FILE INSTEAD, set OCS_OPT_OPTIONS_NOT_OVERLOADED to '1'

# ===== MAIN SETTINGS =====

  # Enable engine logs (see LOGPATH setting)
  PerlSetEnv OCS_OPT_LOGLEVEL 0
  # Specify agent's prolog frequency
  PerlSetEnv OCS_OPT_PROLOG_FREQ 12
  # Specify if agent take contact on service startup
  PerlSetEnv OCS_OPT_INVENTORY_ON_STARTUP 0
  # Configure the duplicates detection system
  PerlSetEnv OCS_OPT_AUTO_DUPLICATE_LVL 15
  # Futur security improvements
  PerlSetEnv OCS_OPT_SECURITY_LEVEL 0
  # Validity of a computer's lock
  PerlSetEnv OCS_OPT_LOCK_REUSE_TIME 600
  # Enable the history tracking system (useful for external data synchronisation
  PerlSetEnv OCS_OPT_TRACE_DELETED 0
  
# ===== INVENTORY SETTINGS =====
  
  # Specify the validity of inventory data
  PerlSetEnv OCS_OPT_FREQUENCY 0  
  # Configure engine to update inventory regarding to CHECKSUM agent value (lower DB backend load)
  PerlSetEnv OCS_OPT_INVENTORY_DIFF 1
  # Make engine consider an inventory as a transaction (lower concurency, better disk usage)
  PerlSetEnv OCS_OPT_INVENTORY_TRANSACTION 1
  # Configure engine to make a differential update of inventory sections (row level). Lower DB backend load, higher frontend load
  PerlSetEnv OCS_OPT_INVENTORY_WRITE_DIFF 1
  # Enable some stuff to improve DB queries, especially for GUI multicriteria searching system
  PerlSetEnv OCS_OPT_INVENTORY_CACHE_ENABLED 1
  # Specify when the engine will clean the inventory cache structures
  PerlSetEnv OCS_OPT_INVENTORY_CACHE_REVALIDATE 7
  # Enable you to keep trace of every elements encountered in db life
  PerlSetEnv OCS_OPT_INVENTORY_CACHE_KEEP 1

# ===== SOFTWARES DEPLOYMENT SETTINGS =====

  # Enable this feature
  PerlSetEnv OCS_OPT_DOWNLOAD 0
  # Package which have a priority superior than this value will not be downloaded
  PerlSetEnv OCS_OPT_DOWNLOAD_PERIOD_LENGTH 10
  # Time between two download cycles (bandwidth control)
  PerlSetEnv OCS_OPT_DOWNLOAD_CYCLE_LATENCY 60
  # Time between two fragment downloads (bandwidth control)
  PerlSetEnv OCS_OPT_DOWNLOAD_FRAG_LATENCY 60
  # Specify if you want to track packages affected to a group on computer's level
  PerlSetEnv OCS_OPT_DOWNLOAD_GROUPS_TRACE_EVENTS 1
  # Time between two download periods (bandwidth control)
  PerlSetEnv OCS_OPT_DOWNLOAD_PERIOD_LATENCY 60
  # Agents will send ERR_TIMEOUT event and clean the package it is older than this setting
  PerlSetEnv OCS_OPT_DOWNLOAD_TIMEOUT 7
  # Agents will send an error event and clean the package if package command does not respond during this setting
  PerlSetEnv OCS_OPT_DOWNLOAD_EXECUTION_TIMEOUT 120
  
  # Enable ocs engine to deliver agent's files (deprecated)
  PerlSetEnv OCS_OPT_DEPLOY 0
  # Enable the softwares deployment capacity (bandwidth control)
  
# ===== GROUPS SETTINGS =====

  # Enable the computer\s groups feature
  PerlSetEnv OCS_OPT_ENABLE_GROUPS 1
  # Random number computed in the defined range. Designed to avoid computing many groups in the same process
  PerlSetEnv OCS_OPT_GROUPS_CACHE_OFFSET 43200
  # Specify the validity of computer's groups (default: compute it once a day - see offset)
  PerlSetEnv OCS_OPT_GROUPS_CACHE_REVALIDATE 43200
  
# ===== IPDISCOVER SETTINGS =====

  # Specify how much agent per LAN will discovered connected peripherals (0 to disable)
  PerlSetEnv OCS_OPT_IPDISCOVER 2
  # Specify the minimal difference to replace an ipdiscover agent
  PerlSetEnv OCS_OPT_IPDISCOVER_BETTER_THRESHOLD 1
  # Time between 2 arp requests (mini: 10 ms)
  PerlSetEnv OCS_OPT_IPDISCOVER_LATENCY 100
  # Specify when to remove a computer when it has not come until this period
  PerlSetEnv OCS_OPT_IPDISCOVER_MAX_ALIVE 14
  # Disable the time before a first election (not recommended)
  PerlSetEnv OCS_OPT_IPDISCOVER_NO_POSTPONE 0
  # Enable groups for ipdiscover (for example, you might want to prevent some groups to be ipdiscover agents)
  PerlSetEnv OCS_OPT_IPDISCOVER_USE_GROUPS 1
  
# ===== INVENTORY FILES MAPPING SETTINGS =====

  # Use with ocsinventory-injector, enable the multi entities feature
  PerlSetEnv OCS_OPT_GENERATE_OCS_FILES 0
  # Generate either compressed file or clear XML text
  PerlSetEnv OCS_OPT_OCS_FILES_FORMAT OCS
  # Specify if you want to keep trace of all inventory between to synchronisation with the higher level server
  PerlSetEnv OCS_OPT_OCS_FILES_OVERWRITE 0
  # Path to ocs files directory (must be writeable)
  PerlSetEnv OCS_OPT_OCS_FILES_PATH /tmp

# ===== FILTER SETTINGS =====

  # Enable prolog filter stack
  PerlSetEnv OCS_OPT_PROLOG_FILTER_ON 0
  # Enable core filter system to modify some things "on the fly"
  PerlSetEnv OCS_OPT_INVENTORY_FILTER_ENABLED 0
  # Enable inventory flooding filter. A dedicated ipaddress ia allowed to send a new computer only once in this period
  PerlSetEnv OCS_OPT_INVENTORY_FILTER_FLOOD_IP 0
  # Period definition for INVENTORY_FILTER_FLOOD_IP
  PerlSetEnv OCS_OPT_INVENTORY_FILTER_FLOOD_IP_CACHE_TIME 300
  # Enable inventory filter stack
  PerlSetEnv OCS_OPT_INVENTORY_FILTER_ON 0

# ===== DATA FILTER =====

  #Enable the dat filtering capacity
  PerlSetEnv OCS_OPT_DATA_FILTER 0 

  # Set the table names and the field associated you want to filter 
  #PerlAddVar OCS_OPT_DATA_TO_FILTER HARDWARE 
  #PerlAddVar OCS_OPT_DATA_TO_FILTER USERID 

  
# ===== REGISTRY SETTINGS =====

  # Enable the registry capacity
  PerlSetEnv OCS_OPT_REGISTRY 1

# ===== SNMP SETTINGS =====

  # Enable the SNMP capacity
  PerlSetEnv OCS_OPT_SNMP 0
  # Configure engine to update snmp inventory regarding to snmp_laststate table (lower DB backend load)
  PerlSetEnv OCS_OPT_SNMP_INVENTORY_DIFF 1
  # Display error message about agent https communication in logfile
  PerlSetEnv OCS_OPT_SNMP_PRINT_HTTPS_ERROR 1
  
# ===== SESSION SETTINGS =====
# Not yet in GUI

  # Validity of a session (prolog=>postinventory)
  PerlSetEnv OCS_OPT_SESSION_VALIDITY_TIME 600
  # Consider a session obsolete if it is older thant this value
  PerlSetEnv OCS_OPT_SESSION_CLEAN_TIME 86400
  # Accept an inventory only if required by server
  #( Refuse "forced" inventory)
  PerlSetEnv OCS_OPT_INVENTORY_SESSION_ONLY 0

# ===== TAG =====

  # The default behavior of the server is to ignore TAG changes from the
  # agent.
  PerlSetEnv OCS_OPT_ACCEPT_TAG_UPDATE_FROM_CLIENT 0

# ===== EXTERNAL USERAGENTS =====

  #Path for external useragents reference file
  #!! WARNING !! : external agents may not be supported by OCS NG Community ! 
  #PerlSetEnv OCS_OPT_EXT_USERAGENTS_FILE_PATH /tmp/yourfile.txt

# ===== PLUGINS =====

  PerlSetEnv OCS_PLUGINS_PERL_DIR "/etc/ocsinventory-server/perl"
  PerlSetEnv OCS_PLUGINS_CONF_DIR "/etc/ocsinventory-server/plugins"

# ===== DEPRECATED =====

  # Set the proxy cache validity in http headers when sending a file
  PerlSetEnv OCS_OPT_PROXY_REVALIDATE_DELAY 3600
  # Deprecated
  PerlSetEnv OCS_OPT_UPDATE 0
  
############ DO NOT MODIFY BELOW ! #######################
  
  # External modules
  PerlModule Apache::DBI
  PerlModule Compress::Zlib
  PerlModule XML::Simple

  # Ocs plugins
  PerlModule Apache::Ocsinventory::Plugins
  
  # Ocs
  PerlModule Apache::Ocsinventory
  PerlModule Apache::Ocsinventory::Server::Constants
  PerlModule Apache::Ocsinventory::Server::System
  PerlModule Apache::Ocsinventory::Server::Communication
  PerlModule Apache::Ocsinventory::Server::Inventory
  PerlModule Apache::Ocsinventory::Server::Duplicate

  # Capacities
  PerlModule Apache::Ocsinventory::Server::Capacities::Registry
  PerlModule Apache::Ocsinventory::Server::Capacities::Update
  PerlModule Apache::Ocsinventory::Server::Capacities::Ipdiscover
  PerlModule Apache::Ocsinventory::Server::Capacities::Download
  PerlModule Apache::Ocsinventory::Server::Capacities::Notify
  PerlModule Apache::Ocsinventory::Server::Capacities::Snmp
  # This module guides you through the module creation
  # PerlModule Apache::Ocsinventory::Server::Capacities::Example
  # This module adds some rules to filter some request sent to ocs server in the prolog and inventory stages
  # PerlModule Apache::Ocsinventory::Server::Capacities::Filter
  # This module add availibity to filter data from HARDWARE section (data filtered won't be stored in database)
  # PerlModule Apache::Ocsinventory::Server::Capacities::Datafilter
  
  # PerlTaintCheck On

  # SSL apache settings 
  #SSLEngine "SSL_ENABLE"
  #SSLCertificateFile "SSL_CERTIFICATE_FILE"
  #SSLCertificateKeyFile "SSL_CERTIFICATE_KEY_FILE"
  #SSLCACertificateFile "SSL_CERTIFICATE_FILE"
  #SSLCACertificatePath "SSL_CERTIFICATE_PATH"
  #SSLVerifyClient "SSL_VALIDATE_CLIENT"

  # Engine apache settings
  # "Virtual" directory for handling OCS Inventory NG agents communications
  # Be careful, do not create such directory into your web server root document !
  <Location /ocsinventory>
    <IfModule mod_authz_core.c>
      # Apache 2.4
      Require all granted
	</IfModule>
	<IfModule !mod_authz_core.c>
      # Apache 2.2
	  order deny,allow
	  allow from all
	</IfModule>
	#Â If you protect this area you have to deal with http_auth_* agent's parameters
	# AuthType Basic
	# AuthName "OCS Inventory agent area"
	# AuthUserFile "APACHE_AUTH_USER_FILE"
	# require valid-user
        SetHandler perl-script
        PerlHandler Apache::Ocsinventory
  </Location>

  # Web service apache settings
  PerlModule Apache::Ocsinventory::SOAP

  <location /ocsinterface>
        SetHandler perl-script
        PerlHandler "Apache::Ocsinventory::SOAP"
        
        # By default, you can query web service from everywhere with a valid user
		<IfModule mod_authz_core.c>
          # Apache 2.4
          Require all granted
	    </IfModule>
	    <IfModule !mod_authz_core.c>
          Order deny,allow
          Allow from all
		</IfModule>
       	  AuthType Basic
	AuthName "OCS Inventory SOAP Area"
	# Use htpasswd to create/update soap-user (or another granted user)
	AuthUserFile "APACHE_AUTH_USER_FILE"
	<IfModule mod_authz_core.c>
          # Apache 2.4
          Require user "SOAP_USER"
	    </IfModule>
	<IfModule !mod_authz_core.c>
	  require "SOAP_USER"
	    </IfModule>
  </location>
</IfModule>
******** End updated ocsinventory-server.conf.local ***********
Removing old communication server configuration to file /etc/apache2/conf-available/ocsinventory.conf
Writing communication server configuration to file /etc/apache2/conf-available/z-ocsinventory-server.conf
Leaving Apache directory
Communication server installation successful

============================================================
Installing Administration server
============================================================
Checking for Administration Server directories...
Using directory /usr/share/ocsinventory-reports for static files
Using /var/lib/ocsinventory-reports as writable/cache directory
Checking for DBI PERL module
PERL module DBI is available
Checking for DBD::mysql PERL module
PERL module DBD::mysql is available
Checking for XML::Simple PERL module
PERL module XML::Simple is available
Checking for Net::IP PERL module
PERL module Net::IP is available
Creating PHP directory /usr/share/ocsinventory-reports/ocsreports
Copying PHP files to /usr/share/ocsinventory-reports/ocsreports
Fixing permissions on directory /usr/share/ocsinventory-reports/ocsreports
chown: cannot access '/usr/share/ocsinventory-reports/ocsreports/download': No such file or directory
chown: cannot access '/usr/share/ocsinventory-reports/ocsreports/upload': No such file or directory
Creating database configuration file /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php
Creating IPDiscover directory /var/lib/ocsinventory-reports/ipd
Fixing permissions on directory /var/lib/ocsinventory-reports/ipd
Creating packages directory /var/lib/ocsinventory-reports/download
Fixing permissions on directory /var/lib/ocsinventory-reports/download
Creating snmp mibs directory /var/lib/ocsinventory-reports/snmp
Fixing permissions on directory /var/lib/ocsinventory-reports/snmp
Creating Administration server log files directory /var/lib/ocsinventory-reports/logs
Fixing permissions on directory /var/lib/ocsinventory-reports/logs
Creating Administration server temporary files directory /var/lib/ocsinventory-reports/tmp_dir
Fixing permissions on directory /var/lib/ocsinventory-reports/tmp_dir
Creating Administration server scripts log files directory /var/lib/ocsinventory-reports/scripts
Fixing permissions on directory /var/lib/ocsinventory-reports/scripts
Configuring IPDISCOVER-UTIL Perl script (ed ipdiscover-util.pl)
Installing IPDISCOVER-UTIL Perl script
Fixing permissions on IPDISCOVER-UTIL Perl script
Configuring Apache web server (file ocsinventory-reports.conf)
******** Begin updated ocsinventory-reports.conf.local ***********
################################################################################
#
# OCS Inventory NG Administration Server
#
# Copyleft 2008 OCS Inventory NG Team
# Web: http://www.ocsinventory-ng.org
#
# This code is open source and may be copied and modified as long as the source
# code is always made freely available.
# Please refer to the General Public Licence http://www.gnu.org/ or Licence.txt
################################################################################

#
# ANY CHANGE ON THIS FILE REQUIRES APACHE RESTART TO TAKE EFFECT
#

################################################################################
# Administration console public pages
# 
# Alias used to put Administration Server static page (typically PHP) outside
# Apache document root directory
#
Alias /ocsreports /usr/share/ocsinventory-reports/ocsreports

<Directory /usr/share/ocsinventory-reports/ocsreports>
    # By default, users can use console from everywhere
      <IfModule mod_authz_core.c>
        # Apache 2.4
        Require all granted
	  </IfModule>
	  <IfModule !mod_authz_core.c>
        Order deny,allow
        Allow from all
      </IfModule>
    Options Indexes FollowSymLinks
    DirectoryIndex index.php
    AllowOverride Options AuthConfig
    
    # Uncomment following to force use of HTTPS in Administration Server
    #SSLRequireSSL
    
    # PHP tuning (not working on all distribution, use php.ini instead)
    <IfModule mod_php5.c>
        AddType application/x-httpd-php .php
        php_flag file_uploads           on
        # Some PHP tuning for deployment feature up to 8 MB
        # post_max_size must be greater than upload_max_filesize
        # because of HTTP headers 
        php_value post_max_size         101m
        php_value upload_max_filesize   100m
        # You may have to uncomment following on errors
        #php_value max_execution_time -1
        #php_value max_input_time -1
        
        # Uncomment following if you need to specify a mysql socket
    	#php_value mysql.default_socket "path/to/mysql/unix/socket"

        #!! Mandatory !! : set magic_quotes_gpc to off (to make ocsreports works correctly)
        php_flag magic_quotes_gpc      off
    </IfModule>
    # Duplicate for php7 compatibility
    <IfModule mod_php7.c>
        AddType application/x-httpd-php .php
        php_flag file_uploads           on
        # Some PHP tuning for deployment feature up to 8 MB
        # post_max_size must be greater than upload_max_filesize
        # because of HTTP headers 
        php_value post_max_size         101m
        php_value upload_max_filesize   100m
        # You may have to uncomment following on errors
        #php_value max_execution_time -1
        #php_value max_input_time -1
        
        # Uncomment following if you need to specify a mysql socket
    	#php_value mysql.default_socket "path/to/mysql/unix/socket"

        #!! Mandatory !! : set magic_quotes_gpc to off (to make ocsreports works correctly)
        php_flag magic_quotes_gpc      off
    </IfModule>

    # Uncomment following to allow HTTP body request up to 4 MB
    # instead default 512 KB
    #LimitRequestBody 4194304

</Directory>

################################################################################
# Deployment packages download area
# 
# Alias to put Deployment package files outside Apache document root directory
#
<Directory /var/lib/ocsinventory-reports/download>
   <IfModule mod_authz_core.c>
     # Apache 2.4
     Require all granted
   </IfModule>
   <IfModule !mod_authz_core.c>
     Order deny,allow
     Allow from all
   </IfModule>
</Directory>
Alias /download /var/lib/ocsinventory-reports/download


################################################################################
# Snmp communities area
#
# Alias to put Snmp custom Mibs files outside Apache document root directory
#
<Directory /var/lib/ocsinventory-reports/snmp>
   <IfModule mod_authz_core.c>
     # Apache 2.4
     Require all granted
   </IfModule>
   <IfModule !mod_authz_core.c>
     Order deny,allow
     Allow from all
   </IfModule>
</Directory>
Alias /snmp /var/lib/ocsinventory-reports/snmp
******** End updated ocsinventory-reports.conf.local ***********
Writing communication server configuration to file /etc/apache2/conf-available/ocsinventory-reports.conf
Administration server installation successful
